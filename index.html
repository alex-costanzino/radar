<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="InfoDiffusion: Representation Learning Using Information Maximizing Diffusion Models">
  <meta name="keywords" content="InfoDiffusion, Diffusion Models, Representation Learning">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>InfoDiffusion: Representation Learning Using Information Maximizing Diffusion Models</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>



<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">InfoDiffusion: Representation Learning Using Information Maximizing Diffusion Models</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://isjakewong.github.io/">Yingheng Wang</a>,</span>
            <span class="author-block">
              <a href="https://yair-schiff.github.io">Yair Schiff</a>,</span>
            <span class="author-block">
              <a href="https://skylion007.github.io">Aaron Gokaslan</a>,
            </span>
            <span class="author-block">
              <a href="https://vivo.weill.cornell.edu/display/cwid-wep4001">Weishen Pan</a>,
            </span>
            <br> <!-- Line break added here -->
            <span class="author-block">
              <a href="https://wcm-wanglab.github.io/">Fei Wang</a>,
            </span>
            <span class="author-block">
              <a href="https://www.cs.cornell.edu/~cdesa/">Chris De Sa</a>,
            </span>
            <span class="author-block">
              <a href="https://www.cs.cornell.edu/~kuleshov/">Volodymyr Kuleshov</a>
            </span>
          </div>
          
          <div class="is-size-5 publication-authors">
            <span class="author-block"></sup>Cornell University,</span>
            <span class="author-block"></sup>Cornell Tech, NY</span>
          </div>
          
          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- arXiv Link. -->
              <span class="link-block">
                <a href="https://proceedings.mlr.press/v202/wang23ah.html"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2306.08757"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/google/nerfies"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <table style="width: 100%;">
        <tr>
          <td align="center" style="width: 50%;">
            <img src="./static/images/flowchart.drawio-1.png" width="99%" alt="Flowchart">
          </td>
          <td align="center" style="width: 50%;">
            <img src="./static/images/graphicalabstract.drawio_v2-1.png" width="99%" alt="Graphical Abstract">
          </td>
        </tr>
      </table>
      <h2 class="subtitle has-text-centered">
        (<em>Left</em>) Flow chart demonstrating auxiliary-variable diffusion model with mutual information and prior regularization. (<em>Right</em>) InfoDiffusion produces semantically meaningful latent space for a diffusion model. (<em>Top</em>) Smooth latent space. (<em>Bottom</em>) Disentangled, human-interpretable factors of variation.
      </h2>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            While diffusion models excel at generating high-quality samples, their latent variables typically lack semantic meaning and are not suitable for representation learning.
            Here, we propose InfoDiffusion, an algorithm that augments diffusion models with low-dimensional latent variables that capture high-level factors of variation in the data. % (e.g., high-level image attributes like hair color, eye color, etc.)
            InfoDiffusion relies on a learning objective regularized with the mutual information between observed and hidden variables, which improves latent space quality and prevents the latents from being ignored by expressive diffusion-based decoders.
            Empirically, we find that InfoDiffusion learns disentangled and human-interpretable latent representations that are competitive with state-of-the-art generative and contrastive methods, while retaining the high sample quality of diffusion models. 
            Our method enables manipulating the attributes of generated images and has the potential to assist tasks that require exploring a learned latent space to generate quality samples, e.g., generative design.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">

    <div class="columns is-centered">

      <!-- Code Organization. -->
      <div class="column">
        <div class="content">
          <h2 class="title is-3">Code Organization</h2>
          <p>
            The repository is organized as follows:
          </p>
          <ul>
            <li><code>run.py</code>: Routines for training and evaluation</li>
            <li><code>models.py</code>: Diffusion models (InfoDiffusion, DiffAE, regular diffusion), VAEs (InfoVAE, Î²-VAE, VAE)</li>
            <li><code>modules.py</code>: Neural network blocks</li>
            <li><code>sampling.py</code>: DDPM/DDIM sampler, Reverse DDIM sampler, Two-phase sampler, Latent sampler</li>
            <li><code>utils.py</code>: LR scheduler, logging, utils to calculate priors</li>
            <li><code>gen_fid_stats.py</code>: Generate stats used for FID calculation</li>
            <li><code>calc_fid.py</code>: Calculation FID scores</li>
          </ul>
        </div>
      </div>
      <!--/ Code Organization. -->

    </div>

    <!-- Evaluation. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Evaluation</h2>

        <!-- Evaluation Steps. -->
        <div class="content has-text-justified">
          <p>
            Below are the steps required for evaluating the trained diffusion models. Different evaluation runs can be switched using <code>--mode</code>, which takes one of the following values:
          </p>
          <ul>
            <li><code>eval</code>: sampling images from the trained diffusion model.</li>
            <li><code>eval_fid</code>: sampling images for FID score calculation.</li>
            <li><code>save_latent</code>: save the auxiliary variables.</li>
            <li><code>disentangle</code>: run evaluation on auxiliary variable disentanglement.</li>
            <li><code>interpolate</code>: run interpolation between two given input images.</li>
            <li><code>latent_quality</code>: save the auxiliary variables and latent variables for classification.</li>
            <li><code>train_latent_ddim</code>: train the latent diffusion models used in latent sampler.</li>
            <li><code>plot_latent</code>: plot the latent space.</li>
          </ul>
        </div>
        <!--/ Evaluation Steps. -->

      </div>
    </div>
    <!--/ Evaluation. -->

    <!-- Baselines. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Baselines</h2>
        <div class="content has-text-justified">
          <p>
            The baselines can be easily switched by using the argument <code>--model</code>, which takes in one of the following values <code>['diff', 'vae', 'vanilla']</code> where <code>'diff'</code> is for AVDM, <code>'vae'</code> is for the VAE model family, and <code>'vanilla'</code> is for the regular diffusion models.
          </p>
          <p>
            Below is an example to train InfoVAE:
          </p>
          <pre><code>python run.py --model vae --mode train --mmd_weight 0.1 --a_dim 32 --epochs 50 --dataset celeba --batch_size 32 --save_epochs 5 --prior regular --r_seed 64</code></pre>
        </div>
      </div>
    </div>
    <!--/ Baselines. -->

    <!-- Citation. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Citation</h2>
        <div class="content has-text-justified">
          <pre><code>@inproceedings{wang2023infodiffusion,
    title={Infodiffusion: Representation learning using information maximizing diffusion models},
    author={Wang, Yingheng and Schiff, Yair and Gokaslan, Aaron and Pan, Weishen and Wang, Fei and De Sa, Christopher and Kuleshov, Volodymyr},
    booktitle={International Conference on Machine Learning},
    pages={36336--36354},
    year={2023},
    organization={PMLR}
}</code></pre>
        </div>
      </div>
    </div>
    <!--/ Citation. -->

  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
